function dx=crane_rhs(t, x, u)
m_c = 1;
m_w = 2.49;
m_s = 4.09;

k1 = 30.12048192771084;
k2 = 11.39817629179331;
k3 = 75;

g = 9.81;

m1 = m_c/m_w;
m2 = m_c/(m_w+m_s);

u1 = u(1)/m_w;
u2 = u(2)/(m_w+m_s);
u3 = 0;

s = sin(x);
c = cos(x);

V5 = c(5)*s(5)*(x(8)^2)*x(9) - 2*x(10)*x(6) + g*c(5)*c(7);
V6 = 2*x(8)*(c(5)*x(6)*x(9) + s(5)*x(10)) + g*s(7);
V7 = (s(5)^2)*(x(8)^2)*x(9) + g*s(5)*c(7) + (x(6)^2)*x(9);

N1 = u1 - k1*x(2);
N2 = u2 - k2*x(4);
N3 = 0;

dx = zeros(10, 1);

dx(1) = x(2);
dx(2) = N1 + m1*c(5)*N3;
dx(3) = x(4);
dx(4) = N2 + m2*s(5)*s(7)*N3;
dx(5) = x(6);
dx(6) = (s(5)*N1 - c(5)*s(7)*N2 + (m1 - m2*(s(7)^2))*c(5)*s(5)*N3 + V5)/x(9);
dx(7) = x(8);
dx(8) = -(c(7)*N2 + m2*s(5)*c(7)*s(7)*N3 + V6)/(s(5)*x(9));
dx(9) = 0;
dx(10) = 0;
end